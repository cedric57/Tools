{% extends "base.html" %}

{% block title %}{{ context.seo.title }}{% endblock %}
{% block description %}{{ context.seo.description }}{% endblock %}
{% block keywords %}{{ context.seo.keywords }}{% endblock %}
{% block canonical %}{{ context.seo.canonical_url }}{% endblock %}
{% block og_title %}{{ context.seo.og_title }}{% endblock %}
{% block og_description %}{{ context.seo.og_description }}{% endblock %}
{% block twitter_title %}{{ context.seo.og_title }}{% endblock %}
{% block twitter_description %}{{ context.seo.og_description }}{% endblock %}

{% block content %}
<div class="content-header">
    <h1 id="main-heading">üìß Contactez-nous</h1>
    <p class="subtitle">Une question, une suggestion d'outil, ou simplement un mot ? Nous sommes √† votre √©coute !</p>
</div>

<!-- Indicateur visuel de la page active -->
<div class="tool-indicator">
    <span class="tool-badge">Contact</span>
    <span class="tool-action">Message</span>
</div>

{% if context.contact_success %}
<!-- Message de succ√®s -->
<div class="success-message" role="alert">
    <div class="success-icon">‚úÖ</div>
    <div class="success-content">
        <h3>Message envoy√© avec succ√®s !</h3>
        <p>Nous avons bien re√ßu votre message et nous vous r√©pondrons dans les plus brefs d√©lais.</p>
        <div class="success-details">
            <p><strong>R√©capitulatif :</strong></p>
            <ul>
                <li><strong>Nom :</strong> {{ context.original_name }}</li>
                <li><strong>Email :</strong> {{ context.original_email }}</li>
                <li><strong>Sujet :</strong> {{ context.original_subject }}</li>
                {% if context.original_tool_suggestion %}
                <li><strong>Suggestion d'outil :</strong> {{ context.original_tool_suggestion }}</li>
                {% endif %}
            </ul>
        </div>
        <a href="/contact" class="btn-primary">üìß Envoyer un autre message</a>
    </div>
</div>

{% else %}
<!-- Formulaire de contact -->
<section class="contact-form-section">
    <div class="form-intro">
        <h2>Envoyez-nous un message</h2>
        <p>Nous appr√©cions vos retours et suggestions pour am√©liorer nos outils. N'h√©sitez pas √† nous contacter !</p>
    </div>

    {% if context.contact_error %}
    <div class="error" role="alert">
        <strong>Erreur :</strong> {{ context.contact_error }}
    </div>
    {% endif %}

    <form method="post" action="/contact" class="contact-form" role="form">
        <div class="form-row">
            <div class="form-group">
                <label for="name">Votre nom *</label>
                <input type="text" id="name" name="name"
                       value="{{ context.original_name or '' }}"
                       placeholder="Votre nom complet"
                       required
                       aria-describedby="name-help">
                <small id="name-help">Comment souhaitez-vous que nous vous appelions ?</small>
            </div>

            <div class="form-group">
                <label for="email">Votre email *</label>
                <input type="email" id="email" name="email"
                       value="{{ context.original_email or '' }}"
                       placeholder="votre@email.com"
                       required
                       aria-describedby="email-help">
                <small id="email-help">Nous ne partagerons jamais votre email avec des tiers.</small>
            </div>
        </div>

        <div class="form-group">
            <label for="subject">Sujet du message *</label>
            <select id="subject" name="subject" required aria-describedby="subject-help">
                <option value="">Choisissez un sujet...</option>
                <option value="Suggestion d'outil" {% if context.original_subject == 'Suggestion d\'outil' %}selected{% endif %}>üí° Suggestion d'outil</option>
                <option value="Probl√®me technique" {% if context.original_subject == 'Probl√®me technique' %}selected{% endif %}>üêõ Probl√®me technique</option>
                <option value="Question g√©n√©rale" {% if context.original_subject == 'Question g√©n√©rale' %}selected{% endif %}>‚ùì Question g√©n√©rale</option>
                <option value="Collaboration" {% if context.original_subject == 'Collaboration' %}selected{% endif %}>ü§ù Collaboration</option>
                <option value="Autre" {% if context.original_subject == 'Autre' %}selected{% endif %}>üìù Autre</option>
            </select>
            <small id="subject-help">Choisissez la cat√©gorie qui correspond le mieux √† votre message.</small>
        </div>

        <div class="form-group" id="tool-suggestion-group"
             style="display: {% if context.original_subject == 'Suggestion d\'outil' or context.original_tool_suggestion %}block{% else %}none{% endif %};">
            <label for="tool_suggestion">Quel outil souhaiteriez-vous voir ajout√© ?</label>
            <input type="text" id="tool_suggestion" name="tool_suggestion"
                   value="{{ context.original_tool_suggestion or '' }}"
                   placeholder="Ex: Convertisseur JSON, G√©n√©rateur de QR Code, etc."
                   aria-describedby="tool-help">
            <small id="tool-help">D√©crivez bri√®vement l'outil que vous aimeriez utiliser.</small>
        </div>

        <div class="form-group">
            <label for="message">Votre message *</label>
            <textarea id="message" name="message"
                      placeholder="D√©crivez en d√©tail votre question, suggestion ou probl√®me..."
                      required
                      rows="6"
                      aria-describedby="message-help">{{ context.original_message or '' }}</textarea>
            <small id="message-help">Soyez aussi pr√©cis que possible pour que nous puissions vous aider au mieux.</small>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn-primary">
                üì§ Envoyer le message
            </button>
            <button type="reset" class="btn-secondary">
                üßπ Effacer
            </button>
        </div>
    </form>
</section>

<!-- Informations de contact alternatives -->
<section class="contact-info">
    <h2>Autres moyens de nous contacter</h2>
    <div class="contact-methods">
        <div class="contact-method">
            <div class="method-icon">üìã</div>
            <h3>Suggestions d'outils</h3>
            <p>Vous avez une id√©e d'outil qui pourrait √™tre utile ? N'h√©sitez pas √† nous en faire part !</p>
        </div>

        <div class="contact-method">
            <div class="method-icon">üêõ</div>
            <h3>Signaler un probl√®me</h3>
            <p>Vous avez rencontr√© un bug ou un dysfonctionnement ? Aidez-nous √† am√©liorer nos outils.</p>
        </div>

        <div class="contact-method">
            <div class="method-icon">üí°</div>
            <h3>Am√©liorations</h3>
            <p>Vous avez des id√©es pour am√©liorer nos outils existants ? Nous sommes ouverts √† vos suggestions.</p>
        </div>
    </div>
</section>

<!-- FAQ de contact -->
<section class="contact-faq">
    <h2>Questions fr√©quentes</h2>

    <article class="faq-item">
        <h3>‚è±Ô∏è Dans combien de temps vais-je recevoir une r√©ponse ?</h3>
        <p>Nous nous effor√ßons de r√©pondre √† tous les messages dans un d√©lai de 24 √† 48 heures.</p>
    </article>

    <article class="faq-item">
        <h3>üîß Puis-je proposer un nouvel outil ?</h3>
        <p>Absolument ! Nous adorons recevoir des suggestions d'outils. D√©crivez-nous votre id√©e et nous l'√©tudierons.</p>
    </article>

    <article class="faq-item">
        <h3>üêõ Comment signaler un bug ?</h3>
        <p>Utilisez le formulaire ci-dessus en s√©lectionnant "Probl√®me technique". D√©crivez le probl√®me en d√©tail, y compris les √©tapes pour le reproduire.</p>
    </article>
</section>
{% endif %}

<script>
// Afficher/masquer le champ de suggestion d'outil selon le sujet
document.addEventListener('DOMContentLoaded', function() {
    const subjectSelect = document.getElementById('subject');
    const toolSuggestionGroup = document.getElementById('tool-suggestion-group');

    if (subjectSelect && toolSuggestionGroup) {
        subjectSelect.addEventListener('change', function() {
            if (this.value === 'Suggestion d\'outil') {
                toolSuggestionGroup.style.display = 'block';
            } else {
                toolSuggestionGroup.style.display = 'none';
            }
        });
    }

    // Focus sur le premier champ
    const firstInput = document.querySelector('input[type="text"], input[type="email"], select');
    if (firstInput) {
        firstInput.focus();
    }
});
</script>
{% endblock %}
